<!DOCTYPE html>
<html lang="ko">
  <head>
    <!-- < include('include/head', {title: '로그인'}) %> -->
    <link rel="stylesheet" href="/static/css/login.css" />

    <!-- axios CDN -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <div class="login-box">
      <h1>로그인</h1>
      <p>
        참고! 정답 아이디는 <b>sesac</b> 이고<br />
        비밀번호는 <b>1234</b> 입니다.
      </p>

      <!-- 폼전송으로 로그인 진행 -->

      <form name="form_info" action="/" method="POST">
        <input type="hidden" name="nickname" />
      </form>

      <form name= "form_login" action="/login" method="POST">
        <div class="input-group mb-3">
          <span class="input-group-text" id="id">ID</span>
          <input
            type="text"
            class="form-control"
            aria-label="id input"
            aria-describedby="id"
            name="id"
          />
        </div>
        <div class="input-group mb-3">
          <span class="input-group-text" id="pw">PW</span>
          <input
            type="password"
            class="form-control"
            aria-label="pw input"
            aria-describedby="pw"
            name="pw"
          />
        </div>

        <button type="submit" class="btn btn-dark" onclick="login()">Login</button>
        <br />
        <a href="/">Home 이동하기</a>
        <a href="/join">회원가입으로 이동하기</a>
      </form>
    </div>

    <script>
      function login() {
        const formInfo = document.forms["form_info"];
        const form = document.forms["form_login"];

        if (!form.checkValidity()) {
          form.reportValidity();
          return;
        }

        axios({
          url : "/login",
          method : "POST",
          data: {
            id: form.id.value,
            pw: form.pw.value,
          },
        })
        .then((res) => {
          const { data } = res;

          if (data) {
            alert("로그인 성공");
            formInfo.id.value = form.id.value;
            formInfo.submit();
          }
          else {
            alert("로그인 실패");
            form.reset();
          }
        })
        .catch((err) => console.err(err));
      }
    </script>
  </body>
</html>